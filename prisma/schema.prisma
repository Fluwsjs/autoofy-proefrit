// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Tenant {
  id        String    @id @default(cuid())
  name      String
  email     String    @unique
  createdAt DateTime  @default(now())
  users     User[]
  testrides Testride[]
}

model DealerPlate {
  id        String   @id @default(cuid())
  plate     String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId    String
  createdAt DateTime @default(now())
  testrides Testride[]
}

model User {
  id                String   @id @default(cuid())
  tenant            Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  tenantId          String
  name              String
  email             String   @unique
  password          String
  role              Role     @default(STAFF)
  sellerSignatureUrl String? // Eenmalige verkoper handtekening/stempel (herbruikbaar)
  createdAt         DateTime @default(now())
  dealerPlates      DealerPlate[]
}

model Testride {
  id                  String    @id @default(cuid())
  tenant              Tenant    @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  tenantId            String
  customerName        String
  customerEmail       String
  customerPhone       String?
  address             String
  startTime           DateTime
  endTime             DateTime
  date                DateTime
  carType             String
  licensePlate        String?
  driverLicenseNumber String?
  dealerPlateId       String?
  dealerPlate         DealerPlate? @relation(fields: [dealerPlateId], references: [id], onDelete: SetNull)
  idPhotoFrontUrl     String?   // ID foto voorkant
  idPhotoBackUrl      String?  // ID foto achterkant
  customerSignatureUrl String? // Klant handtekening (per proefrit)
  sellerSignatureUrl   String?  // Verkoper handtekening/stempel (optioneel, kan van User komen)
  eigenRisico         String?  // Eigen risico bedrag
  startKm             Int
  endKm               Int?
  notes               String?
  createdAt           DateTime  @default(now())
}

enum Role {
  ADMIN
  STAFF
}

model SuperAdmin {
  id        String   @id @default(cuid())
  name      String
  email     String   @unique
  password  String
  createdAt DateTime @default(now())
}

